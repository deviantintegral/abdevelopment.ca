<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">


<!-- Mirrored from www.abdevelopment.ca/blog/fixing-enter-key-ahah-forms?page=0%2C5 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 26 Mar 2017 18:38:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Fixing the Enter Key on AHAH Forms | Andrew Berry Development</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../../sites/all/themes/portfolio/favicon/index.ico" type="image/x-icon" />
<link rel="alternate" type="application/rss+xml" title="Recent Story Comments" href="feed/" />
  <link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/codefilter/codefilter/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/aggregator/aggregator/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/node/node/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/system/defaults/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/system/system/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/system/system-menus/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/user/user/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/cck/theme/content-module/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/date/date/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/date/date_popup/themes/datepicker/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/date/date_popup/themes/jquery.timeentry/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/img_assist/img_assist/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/lightbox2/css/lightbox/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/mollom/mollom/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/cck/modules/fieldgroup/fieldgroup/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/modules/views/css/views/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../modules/comment/comment/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/portfolio/html-elements/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/zen/zen/tabs/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/zen/zen/messages/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/zen/zen/block-editing/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/zen/zen/wireframes/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/portfolio/layout/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/portfolio/portfolio/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/portfolio/style/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/portfolio/content-field-field_project_features/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/portfolio/view-nodequeue-1/index.css?e" />
<link type="text/css" rel="stylesheet" media="all" href="../../sites/all/themes/portfolio/view-projects/index.css?e" />
<link type="text/css" rel="stylesheet" media="print" href="../../sites/all/themes/portfolio/print/index.css?e" />
<!--[if IE]>
<link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/zen/zen/ie.css?e" />
<![endif]-->
  <!--[if IE]>
          <link rel="stylesheet" href="//ie.css" type="text/css">
      <![endif]-->
  <script type="text/javascript" src="../../misc/jquery/index.js?e"></script>
<script type="text/javascript" src="../../misc/drupal/index.js?e"></script>
<script type="text/javascript" src="../../sites/all/modules/img_assist/img_assist/index.js?e"></script>
<script type="text/javascript" src="../../sites/all/modules/lightbox2/js/auto_image_handling/index.js?e"></script>
<script type="text/javascript" src="../../sites/all/modules/lightbox2/js/lightbox/index.js?e"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","lightbox2":{"rtl":0,"file_path":"\/(\\w\\w\/)system\/files","default_image":"\/sites\/all\/modules\/lightbox2\/images\/brokenimage.jpg","border_size":10,"font_color":"000","box_color":"fff","top_position":"","overlay_opacity":"0.8","overlay_color":"000","disable_close_click":1,"resize_sequence":0,"resize_speed":200,"fade_in_speed":400,"slide_down_speed":600,"use_alt_layout":0,"disable_resize":0,"disable_zoom":0,"force_show_nav":0,"show_caption":true,"loop_items":0,"node_link_text":"View Image Details","node_link_target":0,"image_count":"Image !current of !total","video_count":"Video !current of !total","page_count":"Page !current of !total","lite_press_x_close":"press \u003ca href=\"#\" onclick=\"hideLightbox(); return FALSE;\"\u003e\u003ckbd\u003ex\u003c\/kbd\u003e\u003c\/a\u003e to close","download_link_text":"","enable_login":false,"enable_contact":false,"keys_close":"c x 27","keys_previous":"p 37","keys_next":"n 39","keys_zoom":"z","keys_play_pause":"32","display_image_size":"preview","image_node_sizes":"(\\.thumbnail)","trigger_lightbox_classes":"img.thumbnail, img.image-thumbnail","trigger_lightbox_group_classes":"","trigger_slideshow_classes":"","trigger_lightframe_classes":"","trigger_lightframe_group_classes":"","custom_class_handler":0,"custom_trigger_classes":"","disable_for_gallery_lists":1,"disable_for_acidfree_gallery_lists":true,"enable_acidfree_videos":true,"slideshow_interval":5000,"slideshow_automatic_start":true,"slideshow_automatic_exit":true,"show_play_pause":true,"pause_on_next_click":false,"pause_on_previous_click":true,"loop_slides":false,"iframe_width":600,"iframe_height":400,"iframe_border":1,"enable_video":0}});
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var BASE_URL = "../../";
//--><!]]>
</script>
  <script type="text/javascript" src="../../sites/all/themes/portfolio/js/fix-ie/index.js"></script>
</head>

<body class="not-front not-logged-in node-type-story one-sidebar sidebar-left page-blog-fixing-enter-key-ahah-forms section-blog">

  <div id="page"><div id="page-inner">

    <a name="top" id="navigation-top"></a>

    <div id="header"><div id="header-inner" class="clear-block">

              <div id="logo-title">

          
                                  <div id='site-name'>
              <a href="../../" title="Home" rel="home">
                <strong>Andrew Berry Development</strong>
              </a>
            </div>
          
          
        </div> <!-- /#logo-title -->
      
      
    </div></div> <!-- /#header-inner, /#header -->

    <div id="main"><div id="main-inner" class="clear-block with-navbar">

      <div id="content"><div id="content-inner">

        
        
                  <div id="content-header">
            <div class="breadcrumb"><a href="../../">Home</a></div>                          <h1 class="title">Fixing the Enter Key on AHAH Forms</h1>
                                              </div> <!-- /#content-header -->
        
        <div id="content-area">
          <div class="node " id="node-78"><div class="node-inner">

  
  
  
      <div class="submitted">
      Submitted by andrew on Mon, 01/19/2009 - 20:29    </div>
  
      <div class="taxonomy"> in <ul class="links inline"><li class="taxonomy_term_4 first"><a href="../../category/tags/drupal/" rel="tag" title="">drupal</a></li>
<li class="taxonomy_term_49"><a href="../../category/tags/javascript/" rel="tag" title="">javascript</a></li>
<li class="taxonomy_term_8 last"><a href="../../category/tags/web-development/" rel="tag" title="">web development</a></li>
</ul></div>
  
  <div class="content">
    <p><strong>Update:</strong> I've modified the suggested JavaScript code to not break #autocomplete enter presses.</p>
<p>The <code>#ahah</code> element introduced in Drupal 6 makes setting up dynamic JavaScript-driven forms much simpler than with Drupal 5. To see this in action, take a look at the Poll module. When adding more choices to a form, clicking the "Add another choice" button doesn't reload the page if JavaScript is enabled. However, there is one problem with such a form: by adding a submit button above other submit elements, it becomes the default action when pressing the enter key. Unfortunately, browsers don't have a method to specify the default submit action, and usually just use the first submit element on the form. To see this issue, try pressing the enter key inside the Title field on a Poll node. The page reloads, and the JS-disabled fallback is executed, instead of the Preview action as may be expected.</p>
<p>This might be behaving as intended with the <a href="https://api.drupal.org/api/file/modules/poll/poll.module/6/source">Poll module</a>, but I wanted to ensure that the enter key action was consistent with a similar feature I was adding to the <a href="https://www.drupal.org/project/skeleton">Skeleton Outline</a> module. Most JavaScript code online will recommend doing something similar to the following:</p>
<div class="codeblock"><code>function processKey(e) {<br />&nbsp;&nbsp;&nbsp; if (null == e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e = window.event ;<br />&nbsp;&nbsp;&nbsp; if (e.keyCode == 13)&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(&quot;#foobar&quot;).click();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br />&nbsp;&nbsp;&nbsp; }<br />}</code></div>
<p>This can then be bound to the appropriate event handler on the form elements. This works perfectly for elements created during page load, but there doesn't seem to be a way to easily bind the function to elements inserted with AHAH. So, any additional textfields inserted would still trigger the unwanted action.</p>
<p>There's another, much simpler way to achieve the same effect on your forms. Include the following on your form page with <a href="https://api.drupal.org/api/function/drupal_add_js/6"><code>drupal_add_js()</code></a>, modified to match the ID's of your elements:</p>
<div class="codeblock"><code>$(document).ready(function() {<br />&nbsp; // If JS is enabled, then override the submit handler so that enter presses<br />&nbsp; // on textfields don&#039;t trigger the no-JS fallback.<br />&nbsp; $(&quot;form#skeleton-create-instance-form #edit-add-introduction&quot;).click(function (){<br />&nbsp;&nbsp;&nbsp; // If any autocomplete fields are open, don&#039;t submit so the enter key can<br />&nbsp;&nbsp;&nbsp; // be used to select an option.<br />&nbsp;&nbsp;&nbsp; if ($(&quot;#autocomplete&quot;).length == 0) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $(&quot;form#skeleton-create-instance-form #edit-submit&quot;).click();<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; return false;<br />&nbsp; });<br />});</code></div>
<p>If you actually click the submit button, the AHAH handler is called, avoiding the above function. When enter is pressed on a form element, the above click handler is called, which then calls the submit button we want to handle the action. False is returned to prevent a double submit. This won't help make submit buttons more consistent for those without JavaScript, but for the vast majority of users it's a very simple way to ensure consistency in your forms.</p>
<div class="field field-type-link field-field-links">
    <div class="field-items">
                  <div class="field-item">
                                  <div class="field-label-inline-first">
                    Related Links:&nbsp;</div>
                                <a href="https://www.drupal.org/node/348475">Introduction to AHAH in Drupal</a>              </div>
        </div>
</div>
  </div>

      <div class="links">
      <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul>    </div>
  
</div></div> <!-- /node-inner, /node -->
  <div id="comments">
          <h2 id="comments-title">Comments</h2>
        <a id="comment-8"></a>
<div class="comment comment-published odd first comment-by-anon"><div class="comment-inner clear-block">

      <h3 class="title">
      <a href="index.html#comment-8" class="active">AHAH Helper</a>          </h3>
  
  
  
  <div class="submitted">
    Submitted by <a href="http://www.krimson.be/" rel="nofollow">Nick_vh</a> (not verified) on Tue, 01/20/2009 - 09:58.  </div>

  <div class="content">
    <p>AHAH Helper also helps you alot in these issues. </p>
<p>as seen in following example from <a href="http://drupal.org/project/ahah_helper" title="http://drupal.org/project/ahah_helper">http://drupal.org/project/ahah_helper</a> we have a little snippet from the example code. If I'm right this code makes sure of the Enter Key submit is submitted by the ajax call and not a new page load. Make sure you check that module because it really is a handy tool for AJAX Forms and it works splendidly :-)</p>
<p>  $form['billing_info']['update_usage'] = array(<br />
    '#type' =&gt; 'submit',<br />
    '#value' =&gt; t('Update usage'),<br />
    // Note that we can simply use the generic submit callback provided by the<br />
    // ahah_helper module here!<br />
    // All it does, is set $form_state['rebuild'] = TRUE.<br />
    '#submit' =&gt; array('ahah_helper_generic_submit'),<br />
    // We set the 'no-js' class, which means this submit button will be hidden<br />
    // automatically by Drupal if JS is enabled.<br />
    '#attributes' =&gt; array('class' =&gt; 'no-js'),<br />
  );</p>
      </div>

      <div class="links">
      <ul class="links"><li class="comment_forbidden first last"></li>
</ul>    </div>
  
</div></div> <!-- /comment-inner, /comment -->
<a id="comment-239"></a>
<div class="comment comment-published even last comment-by-anon"><div class="comment-inner clear-block">

      <h3 class="title">
      <a href="index.html#comment-239" class="active">Mousedown handler</a>          </h3>
  
  
  
  <div class="submitted">
    Submitted by <a href="http://www.benjaminshell.com/" rel="nofollow">Ben Shell</a> (not verified) on Wed, 12/23/2009 - 02:18.  </div>

  <div class="content">
    <p>I found that the click event didn't work (it still triggered the non-JS submit), but using the mousedown event worked to solve this problem:<br />
<code>$(&quot;#edit-submit&quot;).trigger(&quot;mousedown&quot;);</code></p>
      </div>

      <div class="links">
      <ul class="links"><li class="comment_forbidden first last"></li>
</ul>    </div>
  
</div></div> <!-- /comment-inner, /comment -->
  </div>
        </div>

        
        
      </div></div> <!-- /#content-inner, /#content -->

              <div id="navbar"><div id="navbar-inner" class="region region-navbar">

          <a name="navigation" id="navigation"></a>

          
                      <div id="primary">
              <ul class="links"><li class="menu-283 first"><a href="../../home/" title="">Home</a></li>
<li class="menu-238"><a href="../../projects/" title="">Projects</a></li>
<li class="menu-239"><a href="../../resume/" title="Resumé">Resumé</a></li>
<li class="menu-279"><a href="../../services/" title="Services">Services</a></li>
<li class="menu-307 last"><a href="../../projects/free-software/" title="">Free Software</a></li>
</ul>            </div> <!-- /#primary -->
          
          
          
        </div></div> <!-- /#navbar-inner, /#navbar -->
      
              <div id="sidebar-left"><div id="sidebar-left-inner" class="region region-left">
          <div id="block-views-blog-block_1" class="block "><div class="block-inner">

      <h2 class="title">
      <span class="top-left-corner">
        <span class="top-right-corner">
          Recent Articles        </span>
      </span>
    </h2>
  
  <div class="content">
    <div class="view view-blog view-id-blog view-display-id-block_1 view-dom-id-1">
    
  
  
      <div class="view-content">
      <div class="item-list">
    <ul>
          <li class="views-row views-row-1 views-row-odd views-row-first">  
  <div class="views-field-title">
                <span class="field-content"><a href="../waterloo-region-december-meeting-drupal-hosting/">Waterloo Region December Meeting: Drupal Hosting</a></span>
  </div>
</li>
          <li class="views-row views-row-2 views-row-even">  
  <div class="views-field-title">
                <span class="field-content"><a href="../story-office-ribbon/">The Story of the Office Ribbon</a></span>
  </div>
</li>
          <li class="views-row views-row-3 views-row-odd">  
  <div class="views-field-title">
                <span class="field-content"><a href="../research-seminar-presentation-increasing-awareness-privacy-policies-through-graphical-represent/">Research Seminar Presentation: Increasing Awareness of Privacy Policies through Graphical Representation</a></span>
  </div>
</li>
          <li class="views-row views-row-4 views-row-even">  
  <div class="views-field-title">
                <span class="field-content"><a href="../trouble-mysql-land/">Trouble in MySQL Land</a></span>
  </div>
</li>
          <li class="views-row views-row-5 views-row-odd views-row-last">  
  <div class="views-field-title">
                <span class="field-content"><a href="../cisters-computer-science-digital-future/">CISters: Computer Science, The Digital Future</a></span>
  </div>
</li>
      </ul>
</div>    </div>
  
      <div class="item-list"><ul class="pager"><li class="pager-previous first"><a href="index0%2c4.html?page=0%2C4" class="active">‹‹</a></li>
<li class="pager-current">6 of 10</li>
<li class="pager-next last"><a href="index0%2c6.html?page=0%2C6" class="active">››</a></li>
</ul></div>  
  
      
<div class="more-link">
  <a href="../../home/">
    more  </a>
</div>
  
  
  
</div>   </div>

  
</div></div> <!-- /block-inner, /block -->
<div id="block-views-node_comments_2-block_1" class="block "><div class="block-inner">

      <h2 class="title">
      <span class="top-left-corner">
        <span class="top-right-corner">
          Recent Story Comments        </span>
      </span>
    </h2>
  
  <div class="content">
    <div class="view view-node-comments-2 view-id-node_comments_2 view-display-id-block_1 view-dom-id-2">
    
  
  
      <div class="view-content">
      <div class="item-list">
    <ul>
          <li class="views-row views-row-1 views-row-odd views-row-first">  
  <div class="views-field-subject">
                <span class="field-content"><a href="index.html#comment-239" class="active">Mousedown handler</a></span>
  </div>
</li>
          <li class="views-row views-row-2 views-row-even views-row-last">  
  <div class="views-field-subject">
                <span class="field-content"><a href="index.html#comment-8" class="active">AHAH Helper</a></span>
  </div>
</li>
      </ul>
</div>    </div>
  
  
  
  
  
      <div class="feed-icon">
      <a href="feed/" class="feed-icon"><img src="../../misc/feed/index.png" alt="Syndicate content" title="Recent Story Comments" width="16" height="16" /></a>    </div>
  
</div>   </div>

  
</div></div> <!-- /block-inner, /block -->
        </div></div> <!-- /#sidebar-left-inner, /#sidebar-left -->
      
      
    </div></div> <!-- /#main-inner, /#main -->

    <div id="footer"><div id="footer-inner" class="region region-footer">

      <div id="footer-message">Andrew Berry Development</div>

      
    </div></div> <!-- /#footer-inner, /#footer -->

  </div></div> <!-- /#page-inner, /#page -->

  
  
</body>

<!-- Mirrored from www.abdevelopment.ca/blog/fixing-enter-key-ahah-forms?page=0%2C5 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 26 Mar 2017 18:38:52 GMT -->
</html>
